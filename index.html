<script type="module">
    // ... (–≤–µ—Å—å –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∫–æ–¥ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è)

    window.viewProfile = () => {
        window.showSec('profile');
        document.getElementById('profHead').innerHTML = `
            <div class="post-card" style="text-align:center">
                <div style="position:relative; display:inline-block">
                    <img src="${myP.avatar}" class="avatar ${myP.isPrem?'prem-border':''}" style="width:100px; height:100px; border-radius:30px; object-fit:cover">
                    <div onclick="window.editAvatar()" style="position:absolute; bottom:0; right:0; background:var(--p); width:30px; height:30px; border-radius:10px; display:flex; align-items:center; justify-content:center; cursor:pointer; font-size:14px; border:2px solid var(--card)">üì∑</div>
                </div>
                <h2 style="margin:10px 0 5px 0">${myP.name}</h2>
                <div style="display:flex; gap:10px; justify-content:center; margin-bottom:15px">
                    <button class="btn-primary" style="width:auto; padding:5px 15px; font-size:12px" onclick="window.editName()">–ò–∑–º–µ–Ω–∏—Ç—å –∏–º—è</button>
                </div>
                <p style="color:var(--gray); font-size:14px">–í–∞—à–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏:</p>
            </div>`;
        
        const pDiv = document.getElementById('profPosts'); 
        pDiv.innerHTML = "";
        // –§–∏–ª—å—Ç—Ä—É–µ–º –ø–æ—Å—Ç—ã, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏
        const myPosts = allPosts.filter(p => p.uid === auth.currentUser.uid);
        if(myPosts.length === 0) pDiv.innerHTML = "<p style='text-align:center; color:var(--gray)'>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø–æ—Å—Ç–æ–≤</p>";
        myPosts.forEach(p => pDiv.innerHTML += createPostHTML(p));
    };

    // –§—É–Ω–∫—Ü–∏—è —Å–º–µ–Ω—ã –∞–≤–∞—Ç–∞—Ä–∫–∏
    window.editAvatar = async () => {
        const newAv = prompt("–í–≤–µ–¥–∏—Ç–µ –ø—Ä—è–º—É—é —Å—Å—ã–ª–∫—É –Ω–∞ —Ñ–æ—Ç–æ (URL) –∏–ª–∏ –≤–∞—à–µ –∏–º—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∫–æ–Ω–∫–∏:", myP.avatar);
        if(newAv) {
            let finalUrl = newAv;
            // –ï—Å–ª–∏ –≤–≤–µ–¥–µ–Ω–∞ –Ω–µ —Å—Å—ã–ª–∫–∞, –∞ –ø—Ä–æ—Å—Ç–æ —Ç–µ–∫—Å—Ç, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∏–∫–æ–Ω–∫—É
            if(!newAv.startsWith('http')) {
                finalUrl = `https://ui-avatars.com/api/?name=${encodeURIComponent(newAv)}&background=random&size=128`;
            }
            await updateDoc(doc(db, "users", auth.currentUser.uid), { avatar: finalUrl });
            // –û–±–Ω–æ–≤–ª—è–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, —á—Ç–æ–±—ã —Å—Ä–∞–∑—É —É–≤–∏–¥–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            myP.avatar = finalUrl;
            window.viewProfile();
        }
    };

    // –§—É–Ω–∫—Ü–∏—è —Å–º–µ–Ω—ã –∏–º–µ–Ω–∏
    window.editName = async () => {
        const newN = prompt("–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –∏–º—è:", myP.name);
        if(newN && newN.length > 1) {
            await updateDoc(doc(db, "users", auth.currentUser.uid), { name: newN });
            myP.name = newN;
            window.viewProfile();
        }
    };
    
    // ... (–æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ —Å–∏—Å—Ç–µ–º—ã)
</script>
